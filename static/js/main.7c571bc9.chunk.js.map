{"version":3,"sources":["components/Selector.js","service/_config.js","service/getData.js","App.js","index.js"],"names":["Selector","label","options","data","setData","setData2","setdirection","setstopsData","FormControl","size","fullWidth","error","length","InputLabel","id","Select","labelId","value","onChange","e","target","undefined","map","item","MenuItem","RouteName","Zh_tw","City","onClick","CityName","RouteUID","CityID","FormHelperText","getAuthorizationHeader","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","update","getHMAC","getPromise","url","a","axios","method","headers","App","React","useState","city","setcity","routes","setroutes","route","setroute","routeData","setrouteData","stopsData","direction","useEffect","then","res","sort","b","localeCompare","catch","err","console","log","getBusRouteByCity","routeName","routeUID","getEstimatedTime","directionButton","str","dir","Box","style","width","color","fontWeight","maxWidth","padding","display","mb","Cities","mr","borderRadius","boxShadow","className","borderBottomLeftRadius","borderBottomRightRadius","href","RouteMapImageUrl","rel","marginLeft","textAlign","DepartureStopNameZh","Divider","orientation","borderColor","flexItem","DestinationStopNameZh","index","Direction","margin","EstimateTime","toFixed","fontSize","StopName","light","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7c571bc9.chunk.js","sourcesContent":["import React from 'react';\r\n// MUI\r\nimport InputLabel from '@mui/material/InputLabel';\r\nimport MenuItem from '@mui/material/MenuItem';\r\nimport FormControl from '@mui/material/FormControl';\r\nimport FormHelperText from '@mui/material/FormHelperText';\r\nimport Select from '@mui/material/Select';\r\n//-------------------\r\nexport default function Selector({ label, options, data, setData, setData2, setdirection, setstopsData }) {\r\n    const handleChange = e => {\r\n        setData(e.target.value);\r\n        setdirection(0);\r\n        setstopsData(undefined);\r\n        if (label === \"縣市\")\r\n            setData2(\"\")\r\n    };\r\n\r\n    return (\r\n        <FormControl size=\"small\" fullWidth error={!options.length}>\r\n            <InputLabel id=\"demo-simple-select-label\">{label}</InputLabel>\r\n            <Select\r\n                labelId=\"demo-simple-select-label\"\r\n                id=\"demo-simple-select\"\r\n                value={data}\r\n                label=\"City\"\r\n                onChange={handleChange}\r\n            >\r\n                {options && options.map((item) => (\r\n                    <MenuItem key={item.RouteUID || item.CityID} value={(item.RouteName && item.RouteName.Zh_tw) || item.City}\r\n                        onClick={() => { if (label === \"路線\") setData2(item) }}\r\n                    >{(item.RouteName && item.RouteName.Zh_tw) || item.CityName}</MenuItem>\r\n                ))}\r\n            </Select>\r\n            {!options.length && <FormHelperText>請選擇縣市</FormHelperText>}\r\n        </FormControl >\r\n    );\r\n}\r\n","import jsSHA from 'jssha'\r\n//--------------------\r\nexport function getAuthorizationHeader() {\r\n  let AppID = '125f67eef61d44189819c6378e4da9cb';\r\n  let AppKey = 'Pn9PITNbREc7_yBevt-7udS0UOE';\r\n  let GMTString = new Date().toGMTString();\r\n  let ShaObj = new jsSHA('SHA-1', 'TEXT');\r\n  ShaObj.setHMACKey(AppKey, 'TEXT');\r\n  ShaObj.update('x-date: ' + GMTString);\r\n  let HMAC = ShaObj.getHMAC('B64');\r\n  let Authorization = 'hmac username=\"' + AppID + '\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' + HMAC + '\"';\r\n  return { 'Authorization': Authorization, 'X-Date': GMTString };\r\n}","import axios from 'axios'\r\nimport { getAuthorizationHeader } from 'src/service/_config'\r\n//--------------------\r\nfunction getPromise(url) {\r\n    return (async () => await axios({\r\n        method: 'get',\r\n        url: url,\r\n        headers: getAuthorizationHeader()\r\n    }))()\r\n}\r\n\r\nexport function getBusRouteByCity(setData, city) {\r\n    getPromise(`https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/${city}?$format=JSON`)\r\n        .then(res => {\r\n            setData(res.data.sort((a, b) => ('' + a.RouteName.Zh_tw).localeCompare(b.RouteName.Zh_tw)))\r\n        }).catch(err => console.log(err))\r\n}\r\n\r\nexport function getEstimatedTime(setData, city, routeName, routeUID) {\r\n    getPromise(`https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/${city}/${routeName}?$filter=RouteUID%20eq%20'${routeUID}'&$top=100&$format=JSON`)\r\n        .then(res => {\r\n            if (res.data.length > 0)\r\n                setData(res.data)\r\n        }).catch(err => console.log(err))\r\n}","import React from 'react';\r\n// MUI\r\nimport Box from '@mui/material/Box';\r\nimport Divider from '@mui/material/Divider';\r\nimport MapIcon from '@mui/icons-material/Map';\r\nimport 'src/_global.scss'\r\n// Custom\r\nimport Selector from 'src/components/Selector';\r\nimport { getBusRouteByCity, getEstimatedTime } from 'src/service/getData'\r\nimport Cities from 'src/service/cities.json'\r\n//-------------------\r\nfunction App() {\r\n  const [city, setcity] = React.useState('');\r\n  const [routes, setroutes] = React.useState('');\r\n  const [route, setroute] = React.useState('');\r\n  const [routeData, setrouteData] = React.useState();\r\n  const [stopsData, setstopsData] = React.useState();\r\n  const [direction, setdirection] = React.useState(0);\r\n\r\n  React.useEffect(() => {\r\n    if (city) {\r\n      getBusRouteByCity(setroutes, city,);\r\n    }\r\n    if (city && routeData && routeData.RouteName.Zh_tw && routeData.RouteUID)\r\n      getEstimatedTime(setstopsData, city, routeData.RouteName.Zh_tw, routeData.RouteUID)\r\n\r\n  }, [setroutes, city, routeData]);\r\n\r\n  const directionButton = (str, dir) => (\r\n    <Box\r\n      style={{ width: '50%', color: dir === direction ? '#fff' : '#000', fontWeight: dir === direction ? 'bold' : 'normal' }}\r\n      onClick={() => setdirection(dir)}\r\n    > 往 {str}</Box >\r\n  )\r\n\r\n  return (\r\n    <div style={{ maxWidth: '500px', padding: '12px 20px' }}>\r\n      <Box display=\"flex\" mb={1}>\r\n        <Selector label=\"縣市\" options={Cities} data={city} setData={setcity} setData2={setroute} setdirection={setdirection} setstopsData={setstopsData} />\r\n        {city && routes &&\r\n          <>\r\n            <Box mr={1} />\r\n            <Selector label=\"路線\" options={routes} data={route} setData={setroute} setData2={setrouteData} setdirection={setdirection} setstopsData={setstopsData} />\r\n          </>\r\n        }\r\n      </Box>\r\n\r\n      {routeData &&\r\n        <Box borderRadius={2} boxShadow={3}>\r\n          <Box borderRadius={2} display=\"flex\" className=\"bg-primary300\" style={{ color: '#fff', padding: '16px 32px', borderBottomLeftRadius: '0', borderBottomRightRadius: '0' }}>\r\n            <h2 style={{ width: '100%' }}>{routeData.RouteName.Zh_tw}</h2>\r\n            <a href={routeData.RouteMapImageUrl} target=\"_blank\" rel=\"noreferrer\" style={{ display: 'block', marginLeft: 'auto', color: '#fff' }} ><MapIcon /></a>\r\n          </Box>\r\n          <Box className=\"bg-primary200\" display=\"flex\" style={{ padding: '8px 0', textAlign: 'center' }}>\r\n            {directionButton(routeData.DepartureStopNameZh, 0)}\r\n            <Divider orientation=\"vertical\" style={{ borderColor: '#fff' }} flexItem />\r\n            {directionButton(routeData.DestinationStopNameZh, 1)}\r\n          </Box>\r\n\r\n          <Box style={{ padding: '8px 20px' }}>\r\n            {stopsData ? stopsData.map((item, index) => (\r\n              item.Direction === direction && (\r\n                <>\r\n                  <Box display=\"flex\" style={{ padding: '8px 0' }}>\r\n                    <Box borderRadius={2} display=\"flex\" className=\"border-primary400\">\r\n                      <p className=\"primary400\" style={{ width: '60px', textAlign: 'center', margin: 'auto 0' }}>\r\n                        {item.EstimateTime ? <span>{(item.EstimateTime / 60).toFixed(0)}分</span> : <span style={{ fontSize: '10px' }}>尚未發車</span>}\r\n                      </p>\r\n                    </Box>\r\n                    <p style={{ margin: 'auto 0 auto 8px', fontWeight: 'bold' }}>{item.StopName.Zh_tw}</p>\r\n                  </Box>\r\n                  <Divider light />\r\n                </>)\r\n            )) : <>暫無資料</>}\r\n          </Box>\r\n        </Box>\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}